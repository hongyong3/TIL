# 20190620

## Blcok Chain



####  탈중앙화의 기여점

* 탈중앙화는 많은 지불 결제의 중개에 드는 비용을 줄일 수 있음

  > 금융기관이 없어도 송금이 가능함



#### 블록체인의 역사 : 

##### 사이퍼 펑크 운동

* 신용카드의 사용은 프라이버시로 부터 안전하지 못하다. 따라서 프라이버시를 지키기 위한 전자 화폐 시스템이 필요하다. 이를 은닉 서명 암호 시스템을 제안한다.
* 신용카드는 널리 쓰이지만 감시에서 자유롭지 않다. 우리는 전자 서명 기반의 거래를 통해 프라이버시를 지켜야 한다. 현금은 거래에 본인 을 하지 않는다. 중앙화는 곧 실패할 것이다.



##### 작업증명과 Bit Gold



#### 비트코인의 등장

* 비트코인은 2009년 처음 발표

  > 그 후 이더리운, R3, 하이퍼렛저가 2015년에 등장함



비트코인과 블록체인은 같지 않지만, 비트코인은 블록체인을 사용한다.



#### 비트코인의 거래

* 비트코인은 탈중앙화된 장부로 이루어짐

  > 참여자가 모든 사람의 거래내역을 저장함 : 분산화
  >
  > 참여자가 합의하여 거래를 결정 : 분권화



#### Peer-to-Peer(P2P) 네트워크

##### 블록체인은 P2P 네트워크를 통해 거래를 저장함

* 클라이언트 / 서버는 계층을 두고 데이터를 전송
* P2P는 동등 계층간의 데이터를 전송하는 기법을 말함
* 피어들은 서버와 클라이언트의 역할을 동시에 함



#### 정의 1.

##### 블록체인의 불가역성

* 한번 기록 / 승인된 데이터는 수정과 삭제가 불가능하여야 한다.

##### 

---

### 블록체인과 디지털 서명



#### 비트코인의 부인방지

* 다른 사람이 자신의 돈을 보낼 수 없어야 함.
* 내가 보냈다는 사실을 추후에 부인할 수 없어야 함.





#### 비트코인의 지갑

* 개인키 생성

  > 256비트의 무작위 숫자 생성 약 10^77^; k

* 공개키 생성

  > k * G(생성 포인트), 개인키 추론 불가; K

* 비트코인 주소 생성

  > Base 58(RIPEMD160(SHA2(K))); A'



* 공개키 기반 구조(PKI)
* 개인키 / 공개키가 비대칭 키로서 활용됨



#### 정의 2.

##### 데이터 출처 검증

* 데이터 저장 시 데이터의 출처를 기록하여야 한다.



---

### 블록 생성과 작업 증명



#### 해시 알고리즘

* 주로 원본 값의 위변조 여부를 확인하는데 활용함
* 출력값으로 입력값을 유추할  없음



#### 트랜잭션의 해시 저장

##### 머클트리(머클루트)

#### 

#### 정의 3.

##### 모두가 검증 가능한 데이터 저장소

* 참여자 모두가 데이터 무결성을 확인할 수 있어야 한다.



#### 비트코인 채굴하기

* 만약 도어락 비밀번호가 4자리면 0000 ~ 9999까지 다 눌러봄
* 작업증명(Proof of Work)



#### 블록체인의 문제

##### 작업증명의 한계

* 과도한 전력소모



##### 이중 지불의 사례

* 이중 지불은 지불이 완전히 승인이 나기 전에 다른 지불을 진행하는 것을 의미함
* 비트코인은 승인에 시간이 걸리기 때문에 이중 지불이 가능함



#### 6승인과 포크

* 포크

  > 이중 지불을 하면 블록의 분기가 발생

* 6승인

  > 블록의 완전 승인은 6개의 블록이 더 생성되어야 함

* 포크 시 블록 승인

  > 먼저 6승인을 성공한 블록이 완전 승인됨



* 일반 노드들은 승인 확률이 높은 블록을 기반으로 블록을 생성함
* 따라서 길이가 길거나 블록 시간이 빠른 쪽에 먼저 블록을 만듦



#### 합의의 의미

* 답을 찾는 과정



#### 정리

##### 블록체인 데이터가 신뢰받는 이유

* 한번 기록 / 승인된 데이터는 수정과 삭제가 불가능하여야 한다.
* 데이터 저장 시 데이터의 출처를 기록해야 한다.
* 참여자 보유 데이터의 무결성을 검증할 수 있어야 한다.
* 모든 참여자가 합의를 이룬 데이터를 저장하여야 한다.



---

### 스마트 컨트랙트의 개요



#### 이더리움의 등장

##### 비탈릭 부테린(당시 21세, 러시아)

* 이더리움 서비스를 통해 네트워크상에서 스마트 컨트랙트를 가능하게 함



#### 스마트 컨트랙트의 기원

* 특정 계약을 스스로 수립, 검증, 이행하기 위한 컴퓨터 프로토콜

* 계약의 보안을 높이기 위한 방안

* 계약 비용을 감소하기 위한 방안

* 1994년 Nick Szabo가 처음으로 smart contract라는 단어를 사용

* Nick said Smart contract is for

  > 악의와 사고적 예외를 최소화한다.
  >
  > 중개자를 최소화한다.
  >
  > 사기에 의한 손실을 낮춘다.
  >
  > 중재 손실을 낮춘다.
  >
  > 강제적으로 실행한다.



#### 블록체인과 스마트 컨트랙트



#### 프로그래머블 머니



#### 스마트 컨트랙트 활용 사례

* 토큰 서비스(ERC20)
* 에스크로 서비스



#### 이더리움 가상 머신

##### Before VM

* 모든 소프트웨어는 운영체제에 맞게 컴파일 되고 실행되어야 함

* C언어는 운영체제에 따라 컴파일러를 다르게 사요함

* 사용되는 운영체제에 따라 프로그램 코드가 다름

  > GCC : Unix 계열



#### 스마트 컨트랙트 배포 및 실행

##### 스마트 계약 생성 과정

* 스마트 계약 코드
  * 컴파일
* 바이트코드
  * 트랜잭션 생성
* 블록체인 블록
  * 배포
* 블록체인 네트워크



##### 스마트 계약 실행 과정

* 사용자 주소 + 함수 주소 + 매개변수
  * 트랜잭션 생성
* 블록체인 블록
  * 실행
* 블록체인 네트워크



#### 튜링 완전성과 가스

* 스마트 계약을 실행하기 위한 수수료

  > 수수료 = 가스가격(Gas Price) * 사용 가스 수
  >
  > 가스가격 : Gwei 단위( 1Gwei = 0.000000001)
  >
  > 단위 가스가격은 사용자가 정의할 수 있으나, 많을수록 빠른처리가 가능함
  >
  > (예) SafeLow : 1Gwei, Fast : 4Gwei
  >
  > 모든 계약에 가스 제한(Gas Limit)를 설정할 수 있음

* 호출하는 함수의 종류에 따라 비용 차등 부여



#### 사례 발굴

* 은행간 거래에 중앙화를 없애고 블록체인 방식을 활용함
* 중앙화에서 오는 중개비용과 해킹의 위험성을 낮춤



#### 공개형 블록체인의 한계

##### 프라이버시(Privacy)

